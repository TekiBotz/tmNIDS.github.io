- [Learning Objectives](#learning-objectivies)
- [Lab Setup](#lab-setup)
- [Logical Network Diagram](#logical-network-diagram)
- [Software/Tools](#softwaretools)
- [Tests](#tests)
- [Output](#output)
- [Conclusion](#conclusion)
- [Link Tree](#link-tree)

## Learning Objectives
***
* Understand tmNIDS and its role in NIDS testing.
* Simulate various attacks using tmNIDS.
* Analyze Suricata alerts generated by tmNIDS tests within the Wazuh dashboard.
* Gain experience in NIDS detection capabilities and security event monitoring.

## Lab Setup
***
Components:
* Ubuntu Server (Hosted on VMWare) running the Wazuh agent, Suricata IDS, and tmNIDS
* Wazuh server (Hosted on Google Cloud Platform)

## Logical Network Diagram
***
![tmNIDS drawio](https://github.com/user-attachments/assets/5edb8feb-ae08-413f-ab10-0d555767a371)

## Software/Tools
***
* Wazuh
* Suricata
* tmNIDS

## Tests
***
1. Install tmNIDS:
    * Download the source code using curl: Â  curl -sSL https://raw.githubusercontent.com/3CORESec/testmynids.org/master/tmNIDS -o /tmp/tmNIDS && chmod +x /tmp/tmNIDS && /tmp/tmNIDS
   * This downloads and executes tmNIDS, providing a list of testing options.
2. Test Scenarios:
![tmNIDSOptions](https://github.com/user-attachments/assets/6850f548-569e-41fc-9987-d12089d60797)

    * Malicious User-Agent (Test 3):
        * Simulates a request with a suspicious User-Agent header.
        * Wazuh dashboard should display an alert (e.g., ET POLICY GNU/LINUX APT User-Agent Outbound) indicating potential package management-related threats.
    * Tor Connection (Test 5):
        * Simulates a connection to a Tor hidden service (.onion).
        * Wazuh dashboard should display alerts related to Tor traffic (e.g., ET POLICY DNS Query for TOR Hidden Domain).
    * All Tests (Test 11):
        * Executes all available tmNIDS tests simultaneously.
        * Wazuh dashboard should display alerts for each successful attack simulation.

## Output
***
* Access the Wazuh manager's "Security Events" module to view alerts generated by Suricata in response to tmNIDS tests.
* Each alert includes details like rule signature, source/destination IP addresses, and severity level.
![WazuhtmNIDSEvents](https://github.com/user-attachments/assets/5bdca9b2-9f74-48d6-82fd-a2718d34c08b)

## Conclusion
***
This project demonstrates the effectiveness of using tmNIDS to test Suricata's detection capabilities within the Wazuh environment. Wazuh's centralized management and visualization of security events allow for efficient monitoring and analysis of potential threats.
### Benefits:
* Gain hands-on experience with NIDS testing and security event monitoring.
* Develop a deeper understanding of Suricata's capabilities and Wazuh's role in security management.

## Link Tree
***
[Linkenin](https://www.linkedin.com/in/jarrale-butts/)
[GitHub](https://github.com/TekiBotz)

This page was customized by Jarrale Butts to enhance your experience.
[Top](#top)
